{% extends './base.html' %}
{% load static %}

{% block title %}
    My Tasks
{% endblock title%}

{% block content %}

<div class="container-fluid bg-tb-view vh-100">
    <br/>
    <div class="col mx-auto">
        <div class="card rounded-2 shadow border-0 mb-3">
            <h2 class="text-center maroon-bg">My Tasks</h2>
          <div class="card-body p-5 bg-white rounded">
            <div class="table-responsive">
                {% if uncompleted or completed %}
                    <h3>Uncompleted Tasks</h3>
                    <table class="table table-striped">
                        <tr>
                            <th>Task ID</th>
                            <th>Task Name</th>
                            <th>Task Description</th>
                            <th>Assigned To</th>
                            <th>Date/Time Due</th>
                            <th>Options</th>
                            <th></th>
                        </tr>
                        {% for item in uncompleted %}
                        <tr>
                            <form action="{% url 'view_my_task' %}" method="POST">
                                {% csrf_token %}
                                <td>{{ item.task_id }}<input type="hidden" name="id" value="{{ item.task_id }}"></td>
                                <td>{{ item.task_name }}</td>
                                <td>{{ item.task_description }}</td>
                                <td>{{ item.staff_netid }}</td>
                                <td>{{ item.date_time_due }}</td>
                                <td><button class="btn btn-secondary" type="submit">Expand Task</button></td>
                            </form>

                        <td><form action="{% url 'complete_task' taskid=item.task_id %}" method="post">
                            {% csrf_token %}
                            <input class="btn btn-danger" type="submit" value="Complete Task" />
                        </form></td>
                        </tr>
                        {% endfor %}
                    </table>

                    <h3>Completed Tasks</h3>
                    <table class="table table-striped">
                        <tr>
                            <th>Task ID</th>
                            <th>Task Name</th>
                            <th>Task Description</th>
                            <th>Assigned To</th>
                            <th>Date/Time Due</th>
                            <th>Task Complete?</th>
                            <th>Date/Time Completion</th>
                        </tr>
                        {% for item in completed %}
                        <tr>
                            <form action="{% url 'view_my_task' %}" method="POST">
                                {% csrf_token %}
                                <td>{{ item.task_id }}<input type="hidden" name="id" value="{{ item.task_id }}"></td>
                                <td>{{ item.task_name }}</td>
                                <td>{{ item.task_description }}</td>
                                <td>{{ item.staff_netid }}</td>
                                <td>{{ item.date_time_due }}</td>
                                <td>{{ item.task_completion }}</td>
                                <td>{{ item.date_time_completion }}</td>
                                <td><button type="submit">Expand Task</button></td>
                            </form>
                        </tr>
                        {% endfor %}
                    </table>
                {% else %}
                    <p>You have no available tasks.</p>
                {% endif %}
            </div>
          </div>
        </div>
    </div>
</div>

{% endblock content %}